version = 0.1

[[task]]
  name = "install"
  deps = ["build"]
  run = """
    cp target/Debug/chp.exe ~/bin/chp2.exe
    cp target/Debug/chp.exe ~/bin/chp.exe
  """

[[task]]
  name = "build"
  deps = ["build:templates"]
  run = "cargo build"

[[task]]
  name = "build:templates"
  engine = "node"
  run = """
    import { readdirSync, readFileSync, writeFileSync } from 'fs';

    let combinedTemplates = 'version = 0.1\\n';
    for (const tpl of readdirSync('templates'))
      combinedTemplates += readFileSync(`templates/${tpl}`).toString() + '\\n';
    
    writeFileSync('src/templates.toml', combinedTemplates);
  """
